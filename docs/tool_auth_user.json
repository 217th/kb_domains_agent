{
  "name": "tool_auth_user",
  "description": "SUMMARY: Resolves user identity against Google Firestore by retrieving an existing ID or creating a new record if the user is missing.\n\nLOGIC (ЛОГИКА РАБОТЫ):\n1. Receives `username` from AGENT_ROOT.\n2. Connects to Google Firestore.\n3. Queries for an existing user document matching the provided name.\n4. If found: Returns the existing `user_id` and sets `is_new_user` to false.\n5. If not found: Creates a new document in Firestore, generates a new `user_id`, and sets `is_new_user` to true.\n6. Returns the result wrapped in a standard success object.\n\nRETURN VALUE (ВОЗВРАЩАЕМОЕ ЗНАЧЕНИЕ):\nReturns a JSON object structured as follows:\n{\n  \"status\": \"success\",\n  \"data\": {\n    \"user_id\": \"string (The unique Firestore ID)\",\n    \"is_new_user\": boolean (true if created now, false if retrieved)\n  }\n}\n\nERRORS (ВОЗМОЖНЫЕ ОШИБКИ):\n- \"FIRESTORE_CONNECTION_ERROR\": Unable to reach Google Firestore. Retry the operation.\n- \"USER_CREATION_FAILED\": Failed to write the new user record (e.g., permissions or storage limits).\n- \"QUERY_FAILED\": Error executing the lookup query.",
  "parameters": {
    "type": "object",
    "properties": {
      "username": {
        "type": "string",
        "description": "The unique name of the user to authenticate or register. Do not guess; use the exact name provided by the context or AGENT_ROOT."
      }
    },
    "required": [
      "username"
    ]
  }
}