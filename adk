#!/usr/bin/env bash

set -euo pipefail

CMD="${1:-}"
shift || true

case "$CMD" in
  web)
    # Use official ADK web entrypoint; AGENTS_DIR should be the parent folder that contains agent folders.
    AGENTS_DIR="${ADK_AGENTS_DIR:-.}"
    exec .venv/bin/adk web "$AGENTS_DIR" "$@"
    ;;
  webui)
    # Launch official ADK Web UI (requires npm and network to fetch adk-web package)
    API_URL="${API_URL:-http://127.0.0.1:8000}"
    # Allow overriding package name/version if needed, default to @google/adk-web
    ADK_WEB_PKG="${ADK_WEB_PKG:-@google/adk-web}"
    exec npx -y "$ADK_WEB_PKG" serve --api "$API_URL" "$@"
    ;;
  chat)
    # Interactive CLI powered by ADK Runner
    exec .venv/bin/adk run kb_adk "$@"
    ;;
  *)
    echo "Usage: ./adk web [uvicorn args] | ./adk webui [--api http://...] (requires npm) | ./adk chat" >&2
    exit 1
    ;;
esac
